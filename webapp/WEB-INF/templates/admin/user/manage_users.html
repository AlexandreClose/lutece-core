<div id="content-box-actions">
	<#if permission_advanced_parameter>
		<form method="post" action="jsp/admin/user/ManageAdvancedParameters.jsp">
			<input type="submit" value="#i18n{portal.users.manage_users.buttonLabelManageAdvancedParameters}" class="button bt-toolbar" />
		</form>		        
    </#if>  

	<form method="post"  action="${url_user_creation}">
      <input type="submit" value="#i18n{portal.users.manage_users.buttonLabelAddUser}" class="button bt-toolbar" />
	</form>
</div>
<div class="content-box">
    <h2 class="content-box-header">#i18n{portal.users.manage_users.titleUserList}</h2>
    <div class="content-box-content">
    <div class="highlight-box">
		<div id="search-users">
			<form method="post" name="search_users" action="jsp/admin/user/ManageUsers.jsp"  >
				<#if (user_levels?has_content)>
				<p>
		                <label for="user_level">#i18n{portal.users.manage_users.search_users.userLevelLabel} :</label>
						<select id="user_level" name="search_user_level">
							<#if (search_admin_user_filter.userLevel > -1) >
								<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllLevels}</option>
		                		<#list user_levels as user_level>
		                			<#if (search_admin_user_filter.userLevel == user_level.id) >
		                    			<option value="${user_level.id}" selected="selected" >${user_level.name}</option>
		                    		<#else>
		                    			<option value="${user_level.id}" >${user_level.name}</option>
		                    		</#if>
		                    	</#list>
		                	<#else>
		                		<option value="noValue" selected="selected" >#i18n{portal.users.manage_users.search_users.labelAllLevels}</option>
		                		<#list user_levels as user_level>
		                			<option value="${user_level.id}" >${user_level.name}</option>
		                		</#list>
		                	</#if>
		                </select>
		            </p>
				</#if>
				<p>
					<label for="access_code" >#i18n{portal.users.manage_users.search_users.labelAccessCode} :</label>
					<input type="text" id="access_code" name="search_access_code" value="${search_admin_user_filter.accessCode}" />
				</p>
				<p>
					<label for="last_name" >#i18n{portal.users.manage_users.search_users.labelLastName} :</label>
					<input type="text"  id="last_name" name="search_last_name" value="${search_admin_user_filter.lastName}" maxlength="100" size="35" tabindex="2" />
				</p>
				<p>
					<label for="first_name">#i18n{portal.users.manage_users.search_users.labelFirstName} :</label>
					<input type="text" id="first_name" name="search_first_name" value="${search_admin_user_filter.firstName}" maxlength="100" size="35" tabindex="3" />
				</p>
				<p>
					<label for="email">#i18n{portal.users.manage_users.search_users.labelEmail} :</label>
					<input type="text" id="email" name="search_email" value="${search_admin_user_filter.email}" maxlength="100" size="35" tabindex="4" />
				</p>
				<p>
		            <label for="status">#i18n{portal.users.manage_users.search_users.labelStatus} :</label>
		            <select id="status" name="search_status" tabindex="5">
		            	<#switch search_admin_user_filter.status >
	                		<#case 0 >
	                			<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
				               	<option value="0" selected="selected" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
								<option value="1" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
	                			<#break>
	                		<#case 1 >
	                			<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
				               	<option value="0" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
								<option value="1" selected="selected" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
	                			<#break>
	                		<#default>
	                			<option value="noValue" selected="selected" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
				               	<option value="0" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
								<option value="1" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
								<#break>
                		</#switch>
		            </select>
				</p>
				<#list attributes_list as attribute>
					<#if attribute.shownInSearch>
						${attribute.getHtmlFormSearchAttribute( search_admin_user_field_filter, locale )}
					</#if>
				</#list>
				<p>
		           	<input type="submit" value="#i18n{portal.users.manage_users.search_users.buttonSearch}" tabindex="6" class="button" name="search_is_search"/>   
		        </p>
			</form>
		</div>
	</div>
    <form method="post" action="jsp/admin/user/ManageUsers.jsp">
        <@paginationAdmin paginator=paginator combo=1 form=0/>
        <#if search_is_search >
   			<input type="hidden" name="search_is_search" value="true"/>
   			<input type="hidden" name="search_user_level" value="${search_admin_user_filter.userLevel}"/>
   			<input type="hidden" name="search_access_code" value="${search_admin_user_filter.accessCode}"/>
   			<input type="hidden" name="search_last_name" value="${search_admin_user_filter.lastName}"/>
   			<input type="hidden" name="search_first_name" value="${search_admin_user_filter.firstName}"/>
   			<input type="hidden" name="search_email" value="${search_admin_user_filter.email}"/>
   			<input type="hidden" name="search_status" value="${search_admin_user_filter.status}"/>
   			<#if search_admin_user_field_filter.listUserFields?exists && search_admin_user_field_filter.listUserFields?has_content>
   				<#list search_admin_user_field_filter.listUserFields as user_field>
   					<#if user_field.attribute.attributeType.className == "fr.paris.lutece.portal.business.user.attribute.AttributeComboBox">
   						<input type="hidden" name="attribute_${user_field.attribute.idAttribute}" value="${user_field.attributeField.idField}"/>
   					<#else>
   						<input type="hidden" name="attribute_${user_field.attribute.idAttribute}" value="${user_field.value}" />
   					</#if>
   				</#list>
   			</#if>
        </#if>
    </form>
    <table>        
        <tr>            
            <th>
            	#i18n{portal.users.manage_users.columnTitleLastName}
            	<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="lastName${sort_search_attribute}" />
            </th>
            <th>
            	#i18n{portal.users.manage_users.columnTitleFirstName}
            	<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="firstName${sort_search_attribute}" />
            </th>
            <th>
            	#i18n{portal.users.manage_users.columnTitleAccessCode}
            	<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="accessCode${sort_search_attribute}" />
             </th>            
            <th>
            	#i18n{portal.users.manage_users.columnTitleEmail}
            	<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="email${sort_search_attribute}" />
            </th>
            <th>#i18n{portal.users.manage_users.columnTitleStatus}</th>
            <#list attributes_list as attribute>
            	<#if attribute.shownInResultList>
            		<th>${attribute.title}</th>
            	</#if>
            </#list>	
            <th>#i18n{portal.users.manage_users.columnTitleActions}</th>
        </tr>
        <#list user_list as user>
        <tr>
            <td><a href="jsp/admin/user/ModifyUser.jsp?id_user=${user.userId}" class="bullet-link" >${user.lastName}</a></td>
            <td>${user.firstName}</td>
            <td><em>${user.accessCode}</em></td>            
            <td><a href="mailto:${user.email}">${user.email}</a></td>
            <td>
                <#if user.status == 0 >
                <img src="images/admin/skin/enable.png" alt="#i18n{portal.users.manage_users.statusLabelEnabled}" />
                <#else>
                <img src="images/admin/skin/disable.png" alt="#i18n{portal.users.manage_users.statusLabelDisabled}" />
                </#if>				
            </td>
            <#assign list_user_fields = map_id_user_list_user_fields["" + user.userId]>
            <#list attributes_list as attribute>
            	<#if attribute.shownInResultList>
           			<td>
           				<#assign index_user_field = 0>
           				<#list list_user_fields as user_field>
           					<#if user_field.attribute.idAttribute == attribute.idAttribute>
           						<#if index_user_field != 0>
           							<br />
           						</#if>
           						<#assign index_user_field = index_user_field + 1>
           						${attribute.getHtmlValue( locale, user_field )}
           					</#if>
           				</#list>
           			</td>
            	</#if>
            </#list>
            <td>
                <a href="jsp/admin/user/RemoveUser.jsp?id_user=${user.userId}" >
                    <img src="images/admin/skin/actions/delete.png" alt="#i18n{portal.users.actions.labelDelete}" title="#i18n{portal.users.actions.labelDelete}" />
                </a>
                <a href="jsp/admin/user/ManageUserRights.jsp?id_user=${user.userId}" >
                    <img src="images/admin/skin/actions/right.png" alt="#i18n{portal.users.actions.labelRights}" title="#i18n{portal.users.actions.labelRights}" />
                </a>
                <a href="jsp/admin/user/ManageUserRoles.jsp?id_user=${user.userId}" >
                    <img src="images/admin/skin/actions/rbac.png" alt="#i18n{portal.users.actions.labelRoles}" title="#i18n{portal.users.actions.labelRoles}" />
                </a>
                <a href="jsp/admin/user/ManageUserWorkgroups.jsp?id_user=${user.userId}" >
                    <img src="images/admin/skin/actions/group.png" alt="#i18n{portal.users.actions.labelWorkgroups}" title="#i18n{portal.users.actions.labelWorkgroups}" />
                </a>
            </td>
        </tr>
        </#list>		
    </table>
	<@paginationAdmin paginator=paginator />
</div>
</div>