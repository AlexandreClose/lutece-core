<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
		<fieldset>
			<legend class="clearfix">#i18n{portal.users.manage_users.titleUserList}
				<#if permission_advanced_parameter>
					<span class="pull-right">
						<form method="post" action="jsp/admin/user/ManageAdvancedParameters.jsp" class="form-inline spaced">
							<button type="submit" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-cog"></i><span class="hidden-phone">&nbsp;#i18n{portal.users.manage_users.buttonLabelManageAdvancedParameters}</span></button>
						</form>
					</span>&nbsp;				
				</#if>
				<#if permission_import_export_users>
				&nbsp;
				<span class="pull-right">
					<form method="post"  action="jsp/admin/user/ExportUsers.jsp" class="form-inline">
						<button type="submit" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-download"></i><span class="hidden-phone">&nbsp;#i18n{portal.users.manage_users.buttonLabelImportExportUsers}</span></button>
					</form>
				</span>
				&nbsp;
				</#if>
				&nbsp;
				<span class="pull-right">
					<form method="post"  action="${url_user_creation}" class="form-inline spaced">
						<button type="submit" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-plus"></i><span class="hidden-phone">&nbsp;#i18n{portal.users.manage_users.buttonLabelAddUser}</span></button>
					</form>
				</span>
			</legend>
			<div class="row">
				<div class="col-xs-12 col-sm-3 col-md-3 well">
					<form class="form-horizontal" method="post" name="search_users" action="jsp/admin/user/ManageUsers.jsp"  >
						<#if (user_levels?has_content)>
							<div class="form-group">
								<label class="col-xs-12 col-sm-12 col-md-12" for="user_level">#i18n{portal.users.manage_users.search_users.userLevelLabel} :</label>
								<div class="col-xs-12 col-sm-12 col-md-12">
									<select id="user_level" name="search_user_level" class="form-control input-sm">
										<#if (search_admin_user_filter.userLevel > -1) >
											<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllLevels}</option>
											<#list user_levels as user_level>
												<#if (search_admin_user_filter.userLevel == user_level.id) >
													<option value="${user_level.id}" selected="selected" >${user_level.name}</option>
												<#else>
													<option value="${user_level.id}" >${user_level.name}</option>
												</#if>
											</#list>
										<#else>
											<option value="noValue" selected="selected" >#i18n{portal.users.manage_users.search_users.labelAllLevels}</option>
											<#list user_levels as user_level>
												<option value="${user_level.id}" >${user_level.name}</option>
											</#list>
										</#if>
									</select>
								</div>
							</div>
						</#if>
						<div class="form-group">
							<label class="col-xs-12 col-sm-12 col-md-12" for="access_code" >#i18n{portal.users.manage_users.search_users.labelAccessCode} :</label>
							<div class="col-xs-12 col-sm-12 col-md-12">
								<input type="text" id="access_code"  class="form-control input-sm" name="search_access_code" value="${search_admin_user_filter.accessCode}" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-12 col-sm-12 col-md-12" for="last_name" >#i18n{portal.users.manage_users.search_users.labelLastName} :</label>
							<div class="col-xs-12 col-sm-12 col-md-12">
								<input type="text" id="last_name"  class="form-control input-sm" name="search_last_name" value="${search_admin_user_filter.lastName}" maxlength="100" size="35" tabindex="2" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-12 col-sm-12 col-md-12" for="first_name">#i18n{portal.users.manage_users.search_users.labelFirstName} :</label>
							<div class="col-xs-12 col-sm-12 col-md-12">
								<input type="text" id="first_name"  class="form-control input-sm" name="search_first_name" value="${search_admin_user_filter.firstName}" maxlength="100" size="35" tabindex="3" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-12 col-sm-12 col-md-12" for="email">#i18n{portal.users.manage_users.search_users.labelEmail} :</label>
							<div class="col-xs-12 col-sm-12 col-md-12">
								<input type="text" id="email"  class="form-control input-sm" name="search_email" value="${search_admin_user_filter.email}" maxlength="100" size="35" tabindex="4" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-xs-12 col-sm-12 col-md-12" for="status">#i18n{portal.users.manage_users.search_users.labelStatus} :</label>
							<div class="col-xs-12 col-sm-12 col-md-12">
								<select id="status" name="search_status" tabindex="5"  class="form-control input-sm">
									<#switch search_admin_user_filter.status >
									<#case 0 >
									<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
									<option value="0" selected="selected" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
									<option value="1" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
									<option value="10" >#i18n{portal.users.anonymize_user.statusLabelAnonymize}</option>
									<#break>
									<#case 1 >
									<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
									<option value="0" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
									<option value="1" selected="selected" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
									<option value="10" >#i18n{portal.users.anonymize_user.statusLabelAnonymize}</option>
									<#break>
									<#case 10 >
									<option value="noValue" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
									<option value="0" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
									<option value="1" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
									<option value="10" selected="selected" >#i18n{portal.users.anonymize_user.statusLabelAnonymize}</option>
									<#break>
									<#default>
									<option value="noValue" selected="selected" >#i18n{portal.users.manage_users.search_users.labelAllStatus}</option>
									<option value="0" >#i18n{portal.users.create_user.statusLabelEnabled}</option>
									<option value="1" >#i18n{portal.users.create_user.statusLabelDisabled}</option>
									<option value="10" >#i18n{portal.users.anonymize_user.statusLabelAnonymize}</option>
									<#break>
									</#switch>
								</select>
							</div>
						</div>
						<#list attributes_list as attribute>
							<#if attribute.shownInSearch>
								${attribute.getHtmlFormSearchAttribute( search_admin_user_field_filter, locale )}
							</#if>
						</#list>
						<div class="form-group">
							<div class="col-xs-12 col-sm-12 col-md-12">
							<button class="btn btn-primary btn-sm" type="submit" name="search_is_search">
								<i class="glyphicon glyphicon-search"></i>
								<span class="hidden-phone" >#i18n{portal.users.manage_users.search_users.buttonSearch}</span>
							</button>
							</div>
						</div>
					</form>
				</div>
				<div class="col-xs-12 col-sm-9 col-md-9">
					<form method="post" action="jsp/admin/user/ManageUsers.jsp">
						<@paginationAdmin paginator=paginator combo=1 form=0/>					
						<#if search_is_search >
							<input type="hidden" name="search_is_search" value="true"/>
							<input type="hidden" name="search_user_level" value="${search_admin_user_filter.userLevel}"/>
							<input type="hidden" name="search_access_code" value="${search_admin_user_filter.accessCode}"/>
							<input type="hidden" name="search_last_name" value="${search_admin_user_filter.lastName}"/>
							<input type="hidden" name="search_first_name" value="${search_admin_user_filter.firstName}"/>
							<input type="hidden" name="search_email" value="${search_admin_user_filter.email}"/>
							<input type="hidden" name="search_status" value="${search_admin_user_filter.status}"/>
							<#if search_admin_user_field_filter.listUserFields?exists && search_admin_user_field_filter.listUserFields?has_content>
								<#list search_admin_user_field_filter.listUserFields as user_field>
									<#if user_field.attribute.attributeType.className == "fr.paris.lutece.portal.business.user.attribute.AttributeComboBox">
										<input type="hidden" name="attribute_${user_field.attribute.idAttribute}" value="${user_field.attributeField.idField}"/>
									<#else>
										<input type="hidden" name="attribute_${user_field.attribute.idAttribute}" value="${user_field.value}" />
									</#if>
								</#list>
							</#if>
						</#if>				
					</form>										   
					<table class="table table-striped table-condensed">		
						<tr>			
							<th>
								#i18n{portal.users.manage_users.columnTitleLastName}
								<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="lastName${sort_search_attribute}" />
							</th>
							<th>
								#i18n{portal.users.manage_users.columnTitleFirstName}
								<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="firstName${sort_search_attribute}" />
							</th>
							<th>
								#i18n{portal.users.manage_users.columnTitleAccessCode}
								<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="accessCode${sort_search_attribute}" />
							</th>			
							<th>
								#i18n{portal.users.manage_users.columnTitleEmail}
								<@sort jsp_url="jsp/admin/user/ManageUsers.jsp" attribute="email${sort_search_attribute}" />
							</th>
							<th>#i18n{portal.users.manage_users.columnTitleStatus}</th>
							<#list attributes_list as attribute>
							<#if attribute.shownInResultList>
							<th>${attribute.title}</th>
							</#if>
							</#list>	
							<th>#i18n{portal.users.manage_users.columnTitleActions}</th>
						</tr>
						<#list user_list as user>
							<tr>
								<td><#if user.status = 10 >#i18n{portal.users.anonymize_user.statusLabelAnonymize}<#else>${user.lastName}</#if></td>
								<td><#if user.status = 10 >#i18n{portal.users.anonymize_user.statusLabelAnonymize}<#else>${user.firstName}</#if></td>
								<td><em><#if user.status = 10 >#i18n{portal.users.anonymize_user.statusLabelAnonymize}<#else>${user.accessCode}</#if></em></td>			
								<td><#if user.status = 10 >#i18n{portal.users.anonymize_user.statusLabelAnonymize}<#else><a href="mailto:${user.email}" title="${user.email}" >${user.email}</a>
									</#if></td>
								<td>
									<#if user.status == 0 >
									<span class="label label-success"><i class="glyphicon glyphicon-ok-sign"></i> #i18n{portal.util.labelEnabled}</span>
									<#else>
									<span class="label label-important"><i class="glyphicon glyphicon-remove-sign"></i> #i18n{portal.util.labelDisabled}</span>
									</#if>				
								</td>
								<#assign list_user_fields = map_id_user_list_user_fields["" + user.userId]>
								<#list attributes_list as attribute>
								<#if attribute.shownInResultList>
								<td>
									<#assign index_user_field = 0>
									<#list list_user_fields as user_field>
									<#if user_field.attribute.idAttribute == attribute.idAttribute>
									<#if index_user_field != 0>
									<br />
									</#if>
									<#assign index_user_field = index_user_field + 1>
									<#if user.status != 10 >${attribute.getHtmlValue( locale, user_field )}</#if>
									</#if>
									</#list>
								</td>
								</#if>
								</#list>
								<td>
									<div class="col-xs-6 col-sm-2 col-md-1">
										<a class="btn btn-primary btn-xs" href="jsp/admin/user/ModifyUser.jsp?id_user=${user.userId}"  title="#i18n{portal.users.actions.labelUpdate}" >
											<i class="glyphicon glyphicon-edit"></i>
										</a>
									</div>
									<div class="col-xs-6 col-sm-2 col-md-1">
									<a class="btn btn-primary btn-xs" href="jsp/admin/user/ModifyUserRights.jsp?id_user=${user.userId}" title="#i18n{portal.users.actions.labelRights}">
										<i class="glyphicon glyphicon-lock"></i>&nbsp;
									</a>
									</div>
									<div class="col-xs-6 col-sm-2 col-md-1">
									<a class="btn btn-primary btn-xs" href="jsp/admin/user/ModifyUserRoles.jsp?id_user=${user.userId}" title="#i18n{portal.users.actions.labelRoles}">
										<i class="glyphicon glyphicon-list-alt"></i>&nbsp;
									</a>
									</div>
									<div class="col-xs-6 col-sm-2 col-md-1">
									<a class="btn btn-primary btn-xs" href="jsp/admin/user/ModifyUserWorkgroups.jsp?id_user=${user.userId}" title="#i18n{portal.users.actions.labelWorkgroups}">
										<i class="glyphicon glyphicon-tags"></i>
									</a>
									</div>
									<#if !user.statusAnonymized>
										<div class="col-xs-6 col-sm-2 col-md-1">
										<a class="btn btn-primary btn-xs" href="jsp/admin/user/AnonymizeAdminUser.jsp?id_user=${user.userId}"  title="#i18n{portal.users.actions.labelAnonymize}" >
											<i class="glyphicon glyphicon-eye-close"></i>
										</a>
										</div>
									</#if>
									<div class="col-xs-6 col-sm-2 col-md-1">
									<a class="btn btn-danger btn-xs" href="jsp/admin/user/RemoveUser.jsp?id_user=${user.userId}" title="#i18n{portal.users.actions.labelDelete}">
										<i class="glyphicon glyphicon-trash"></i>&nbsp;
									</a>
									</div>
								</td>
							</tr>
						</#list>		
					</table>
					<@paginationAdmin paginator=paginator />
				</div>
			</div>
		</fieldset>
	</div>
</div>

